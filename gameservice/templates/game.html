<!DOCTYPE html>
<head>

</head>
<body>
<button id="button1", onclick=changetarget()>Vaihda iFramen target</button> <br><br>
<input id="joku" type="text" name="urlpath" style="width: 400px;"> paste URL</input> <br><br>
<iframe id="freimi" src="C:/Users/saempylae/Koulu/seitti/seitti2017/example-game/example_game.html" height=800 width=90% name="iframe1"></iframe>
<br><br>
<div id="tekstit"><div>

</body>
<script>


	var gs = {};

	window.addEventListener("message", function(evt) {

				// If LOAD, update the score
				if(evt.data.messageType === "SCORE") {

					changemessage("score submitted: " + evt.data.score);
				}

	      else if (evt.data.messageType === "SAVE") {
					gs = evt.data.gameState;
	        changemessage("saved game with score: " + evt.data.gameState.score);
	      }

	      else if (evt.data.messageType === "LOAD_REQUEST") {
					respond();

	      }

	      else if (evt.data.messageType === "SETTING") {
	        adjustIframe(evt.data.options.width, evt.data.options.height);
	        changemessage("settings requested: " + evt.data.options.height + "x" + evt.data.options.width);
	      }

			});

	function changeMessage(msg) {
		document.getElementById("asd").innerHTML = msg;

	}
	function adjustIframe(x, y) {
	  document.getElementById("freimi").width = x;
	  document.getElementById("freimi").height = y;
	}

	function respond() {
		if ( gs == {} ) {
			var msg = {
							"messageType": "ERROR",

						};
		}
		else {
			var msg = {
							"messageType": "ERROR",
							"gameState": gs
						};
		}


		changemessage("Responded with load game with score of: " + gs.score );
		var iframe = document.getElementById("freimi")
		var x = iframe.contentWindow;
		x.postMessage(msg, '*');
	}

	function changetarget() {
		var tekstikentta = document.getElementById("joku");
		var newpath = tekstikentta.value;
		var iframe = document.getElementById("freimi");
		iframe.src = newpath;
	}

	function changemessage(msg) {
		var elem = document.getElementById("tekstit");
		elem.innerHTML += msg +"<br>";
	}
</script>
